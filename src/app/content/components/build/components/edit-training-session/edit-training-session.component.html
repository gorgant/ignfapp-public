<div class="component-container">
  <div class="session-title">{{ $isNewSession() ? CREATE_SESSION_TITLE_VALUE : EDIT_SESSION_TITLE_VALUE }}</div>

  <mat-stepper *ngIf="$isNewSession() || $localTrainingSession()" class="mat-elevation-z5" orientation="vertical" [linear]="true" labelPosition="bottom" #editTrainingSessionStepper>

    <!-- Step 1 -->
    <mat-step  errorMessage="Error collecting video data." [completed]="$stepOneComplete()" [editable]="true" >
      <ng-template matStepLabel>{{ INPUT_YOUTUBE_VIDEO_URL_STEP_LABEL }}</ng-template>
      
      <app-edit-training-session-step-one [editTrainingSessionStepper]="editTrainingSessionStepper" [$localTrainingSession]="$localTrainingSession" (stepOneCompleted)="handleStepOneCompletion($event)" #stepOne></app-edit-training-session-step-one>
      
      <div class="stepper-buttons-container step-one-buttons">
      
        <button class="action-button" *ngIf="$isNewSession() && !(getYoutubeVideoDataProcessing$ | async)" [disabled]="stepOne.youtubeVideoDataForm.invalid" mat-raised-button color="primary" type="button" (click)="stepOne.onGetYoutubeVideoData()">
          {{ FETCH_VIDEO_DATA_BUTTON_VALUE }}
        </button>

        <app-processing-spinner *ngIf="(getYoutubeVideoDataProcessing$ | async)"></app-processing-spinner>

        <button class="action-button" *ngIf="!(getYoutubeVideoDataProcessing$ | async) && (youtubeVideoData$ | async) && !$isNewSession()" [disabled]="stepOne.videoUrl.invalid" mat-raised-button color="primary" type="button" matStepperNext>
          {{ EDIT_SESSION_BUTTON_VALUE }}
        </button>
        
        <button class="action-button" *ngIf="!(getYoutubeVideoDataProcessing$ | async)" color="primary" mat-stroked-button type="button" backButton>
          {{ CANCEL_BUTTON_VALUE }}
        </button>
      
      </div>
    </mat-step>

    <!-- Step 2 -->
    <mat-step [stepControl]="stepTwo.trainingSessionForm" errorMessage="Form is not complete.">
      <ng-template matStepLabel>{{ INPUT_SESSION_DATA_STEP_LABEL }}</ng-template>

      <app-edit-training-session-step-two [$localTrainingSession]="$localTrainingSession" [$isNewSession]="$isNewSession" #stepTwo></app-edit-training-session-step-two>
      
      <div class="stepper-buttons-container step-two-buttons">
            
        <button class="action-button" *ngIf="!(serverRequestProcessing$ | async)" [disabled]="!stepTwo.trainingSessionForm.valid" mat-raised-button color="primary" type="button" (click)="onSubmitTrainingSessionForm()">
          {{ $isNewSession() ? CREATE_SESSION_BUTTON_VALUE : SUBMIT_BUTTON_VALUE }}
        </button>
        <button class="action-button" *ngIf="!(serverRequestProcessing$ | async)" color="primary" mat-stroked-button type="button" backButton>
          {{ CANCEL_BUTTON_VALUE }}
        </button>

        <app-processing-spinner *ngIf="(serverRequestProcessing$ | async)"></app-processing-spinner>

      </div>
    </mat-step>


  </mat-stepper>

  <div class="video-content-container mat-elevation-z5" *ngIf="(youtubeVideoData$ | async) as videoData">
    <img class="video-thumbnail" [src]="videoData.thumbnailUrlLarge" alt="Video Thumbnail">
    <div class="video-details-container">
      <div class="video-details-item">
        <div class="video-details-prefix">{{ TITLE_BLURB }}:</div>
        <div class="video-details-content">{{ videoData.title }}</div>
      </div>
      <div class="video-details-item">
        <div class="video-details-prefix">{{ CHANNEL_BLURB }}:</div>
        <div class="video-details-content">{{ videoData.channelTitle }}</div>
      </div>
      <div class="video-details-item">
        <div class="video-details-prefix">{{ DURATION_BLURB }}:</div>
        <div class="video-details-content">{{ videoData.durationIso | durationIsoToMmSs }}</div>
      </div>
      <!-- <div class="video-details-content"><span class="video-details-prefix">{{ CHANNEL_BLURB }}:</span> {{ videoData.channelTitle }}</div>
      <div class="video-details-content"><span class="video-details-prefix">{{ DURATION_BLURB }}:</span> {{ videoData.durationIso | durationIsoToMmSs }}</div> -->
    </div>
  </div>


</div>
